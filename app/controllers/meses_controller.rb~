class MesesController < ApplicationController 
  def show
		@asignaturas = Evento.all_asignaturas

		@selected_asignaturas = params[:asignaturas] || {}
    
    if @selected_asignaturas == {}
      @selected_asignaturas = Hash[@asignaturas.map {|asignatura| [asignatura, asignatura]}]
    end

    @mes = Mes.find(params[:id])

    eventos = Evento.find_all_by_asignatura(@selected_asignaturas.keys)
    datos= Array.new
    eventos.each do |evento|
      if evento.fecha.month.to_s==@mes.nmes
        datos.push(evento)
      end
    end
    puts "LALALALALALALAALALALALALALAALAAALALALAAAALALAL"
    puts datos[1]
    #year=datos[0].fecha.year.to_s
    @nhuecos = DateTime.parse("2013-#{@mes.nmes}-1").wday-1
    if @nhuecos==-1
      @nhuecos=6
    end
    casillas=@mes.dias+@nhuecos
    listadias=Array.new(casillas) #=> [true, true, true]
    eventosdia=[]
    for i in 1..@mes.dias
      eventosdia=[]
      datos.each do |dato|
        if dato.fecha.day==i
          eventosdia.append(dato)
        end
      end
      listadias[i-1+@nhuecos]=eventosdia
    end
    @listadias=listadias
  end

end
